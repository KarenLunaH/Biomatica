<ui:composition template="/WEB-INF/admin.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

    <ui:define name="title">
        Paciente
    </ui:define>

    <ui:define name="content">
        <f:metadata>
            <f:event type="preRenderView" listener="#{pacienteController.find()}"/>
        </f:metadata>
        
        <p:fieldset legend="Datos generales del Paciente" style="margin-bottom:20px">
            <h:form id="form">     

                <p:panelGrid>

                    <p:row>
                        <p:column>
                            <p:outputLabel value="Nombre: #{pacienteController.paciente}"/>  
                        </p:column>
                    </p:row>
                    
                    <p:row>
                        <p:column>
                            <p:outputLabel value="Telefono: #{pacienteController.paciente.telefono}"/>  
                        </p:column>
                    </p:row>

                    <!--<p:row>
                        <p:column>
                            <p:commandButton value="Modificar" actionListener="#{pacienteBean.findOneByID(paciente)}" oncomplete="PF('widgetDatos').show();" update=":dialogDatos"/>                            
                        </p:column>
                    </p:row>-->

                </p:panelGrid>              
            </h:form> 
        </p:fieldset>
        
        
        <p:accordionPanel id="accordion">
            
            <p:tab id="antescedentesTab" title="Antescedentes">
                 <h:form id="antescedentesForm">
                     <p:panelGrid>
                        <p:row>
                            <p:column>
                                <p:outputLabel rendered="#{!pacienteController.tieneRegistradoAntescedentes()}" value="No tiene antescedentes registrados"/>
                            </p:column>
                        </p:row>
                        <p:row>
                            <p:column>
                                <p:outputLabel rendered="#{pacienteController.tieneRegistradoAntescedentes()}" value="Heredo-Familiares: #{pacienteController.antescedentesConsulta.heredoFam}"/>
                            </p:column>
                        </p:row>
                        <p:row>
                            <p:column>
                                 <p:outputLabel rendered="#{pacienteController.tieneRegistradoAntescedentes()}" value="Personales Patológicos: #{pacienteController.antescedentesConsulta.persoPatologicos} "/>
                            </p:column>
                        </p:row>
                        <p:row>
                            <p:column>
                                <p:outputLabel rendered="#{pacienteController.tieneRegistradoAntescedentes()}" value="Personales no Patológicos: #{pacienteController.antescedentesConsulta.persoNoPato}"/>
                            </p:column>
                        </p:row>
                        <p:row>
                            <p:column>
                                <p:outputLabel rendered="#{pacienteController.tieneRegistradoAntescedentes()}" value="Gineco-Obstétricos: #{pacienteController.antescedentesConsulta.genecoObste} "/>
                            </p:column>
                        </p:row>
                     </p:panelGrid>    
                <p:commandButton rendered="#{!pacienteController.tieneRegistradoAntescedentes()}" value="Registrar antescedentes" oncomplete="PF('widgetAntescedentes').show();" update=":dialogAntescedentes"/>
                <p:commandButton actionListener="#{pacienteController.findAntescedentesEdit()}" rendered="#{pacienteController.tieneRegistradoAntescedentes()}" value="Modificar antescedentes" oncomplete="PF('widgetAntescedentes2').show();" update=":dialogAntescedentes2"/>
                
                 </h:form>
            </p:tab>
            
            <p:tab title="Consultas">
                <p:outputLabel value="To do, hacer consultas form"/>
            </p:tab>
            
            <p:tab title="Imagenes">
                <h:form id="imagenesForm">
                    <p:tabView value="#{pacienteController.paciente.imagenesList}" var="imagen">
                        <p:tab title="#{imagen.nombre}">
                            <p:graphicImage width="800px" height="400px" rendered="#{imagen.hasImage()}" library="imagenes" name="#{imagen.url}"/>
                            <p:commandButton value="Editar" actionListener="#{pacienteController.findForEditImagen(imagen.idImagen)}" oncomplete="PF('widgetImagen2').show();" update=":dialogImagen2"/>
                        </p:tab>
                    </p:tabView>
                    <p:commandButton value="Registrar" actionListener="#{pacienteController.resetUploaded()}" oncomplete="PF('widgetImagen').show();" update=":dialogImagen"/>
                </h:form>
            </p:tab>
            
            <p:tab title="Lista de medicamento">
                <h:form id="medicamentoForm">
                    <h:commandLink>
                        <p:graphicImage library="icons" name="pdfimage.png"/>
                        <p:dataExporter type="pdf" target="medicamentoTable" fileName="Medicamentos_de_#{pacienteController.paciente}" />
                    </h:commandLink>
                    <p:dataTable id="medicamentoTable" value="#{pacienteController.paciente.medicamentoList}" var="medicamento" paginator="true" rows="5">
                        <f:facet name="header">
                            Medicamentos del paciente.
                        </f:facet>                 
                        <p:column headerText="Nombre comercial">
                            <p:outputLabel value="#{medicamento.nombreComercial}"/>
                        </p:column>  
                        <p:column headerText="Marca">
                            <p:outputLabel value="#{medicamento.marca}"/>
                        </p:column>  
                        <p:column headerText="Descripción">
                            <p:outputLabel value="#{medicamento.descripcion}"/>
                        </p:column>  
                        <p:column headerText="Presentación">
                            <p:outputLabel value="#{medicamento.presentacion}"/>
                        </p:column>  
                        <p:column headerText="Nombre genérico">
                            <p:outputLabel value="#{medicamento.nombreGenerico}"/>
                        </p:column>  
                        <p:column headerText="Contraindicaciones ">
                            <p:outputLabel value="#{medicamento.contraIndicaciones}"/>
                        </p:column>  
                        <p:column headerText="Editar" exportable="false">
                         <p:commandButton value="Editar" actionListener="#{pacienteController.findForEditMedicamento(medicamento.idMedicamento)}" oncomplete="PF('widgetMedicamento2').show();" update=":dialogMedicamento2"/>
                         <!-- los dos puntos(:) significan acceder a un formulario fuera de este formulario!-->
                        </p:column>
                        <p:column headerText="Eliminar" exportable="false">
                            <p:commandButton value="Eliminar" actionListener="#{pacienteController.eliminarMedicamento(medicamento)}" update="accordion:medicamentoForm"/>
                        </p:column>
                    </p:dataTable> 
                    <p:commandButton value="Registrar" oncomplete="PF('widgetMedicamento').show();" update=":dialogMedicamento"/>
                </h:form>
            </p:tab>
        </p:accordionPanel>
                
        
         <p:dialog header="Nuevo medicamento" widgetVar="widgetMedicamento" id="dialogMedicamento" modal="true">
            <h:form>
                <p:messages autoUpdate="true"/>
                <p:panelGrid>
                    <!--p componente de librería primefaces-->
                    <p:row>
                        <p:column> 
                            <p:outputLabel value="Nombre comercial:" for="nombreComercial"/>
                            <p:inputText id="nombreComercial" value="#{pacienteController.medicamento.nombreComercial}" required="true" label="Nombre Comercial"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column> 
                            <p:outputLabel value="Marca:" for="Marca"/>
                            <p:inputText id="Marca" value="#{pacienteController.medicamento.marca}" required="true" />
                        </p:column>
                    </p:row><p:row>
                        <p:column> 
                            <p:outputLabel value="Descripción:" for="Descripción"/>
                            <p:inputText id="Descripción" value="#{pacienteController.medicamento.descripcion}" required="true"/>
                        </p:column>
                    </p:row><p:row>
                        <p:column> 
                            <p:outputLabel value="Presentación:" for="Presentación"/>
                            <p:inputText id="Presentación" value="#{pacienteController.medicamento.presentacion}" required="true"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column> 
                            <p:outputLabel value="Nombre genérico:" for="nombreGenerico"/>
                            <p:inputText id="nombreGenerico" value="#{pacienteController.medicamento.nombreGenerico}" required="true" label="Nombre Generico"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column> 
                            <p:outputLabel value="Contraindicaciones: " for="Contraindicaciones"/>
                            <p:inputText id="Contraindicaciones" value="#{pacienteController.medicamento.contraIndicaciones}" required="true"/>
                        </p:column>
                    </p:row>
                </p:panelGrid>
                <p:commandButton value="Registrar" actionListener="#{pacienteController.crearMedicamento()}" oncomplete="if (args &amp;&amp; !args.validationFailed) PF('widgetMedicamento').hide();" update=":accordion:medicamentoForm:medicamentoTable"/>
            </h:form>
        </p:dialog>
        
        
        
        
        
         <p:dialog header="Nuevo medicamento" widgetVar="widgetMedicamento2" id="dialogMedicamento2" modal="true">
            <h:form>
                <p:messages autoUpdate="true"/>
                <p:panelGrid>
                    <!--p componente de librería primefaces-->
                    <p:row>
                        <p:column> 
                            <p:outputLabel value="Nombre comercial:" for="nombreComercial"/>
                            <p:inputText id="nombreComercial" value="#{pacienteController.medicamento.nombreComercial}" required="true" label="Nombre Comercial"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column> 
                            <p:outputLabel value="Marca:" for="Marca"/>
                            <p:inputText id="Marca" value="#{pacienteController.medicamento.marca}" required="true" />
                        </p:column>
                    </p:row><p:row>
                        <p:column> 
                            <p:outputLabel value="Descripción:" for="Descripción"/>
                            <p:inputText id="Descripción" value="#{pacienteController.medicamento.descripcion}" required="true"/>
                        </p:column>
                    </p:row><p:row>
                        <p:column> 
                            <p:outputLabel value="Presentación:" for="Presentación"/>
                            <p:inputText id="Presentación" value="#{pacienteController.medicamento.presentacion}" required="true"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column> 
                            <p:outputLabel value="Nombre genérico:" for="nombreGenerico"/>
                            <p:inputText id="nombreGenerico" value="#{pacienteController.medicamento.nombreGenerico}" required="true" label="Nombre Generico"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column> 
                            <p:outputLabel value="Contraindicaciones: " for="Contraindicaciones"/>
                            <p:inputText id="Contraindicaciones" value="#{pacienteController.medicamento.contraIndicaciones}" required="true"/>
                        </p:column>
                    </p:row>
                </p:panelGrid>
                <p:commandButton value="Editar" actionListener="#{pacienteController.editarMedicamento()}" oncomplete="if (args &amp;&amp; !args.validationFailed) PF('widgetMedicamento2').hide();" update=":accordion:medicamentoForm:medicamentoTable"/>
            </h:form>
        </p:dialog>
        
        
        
        
        <p:dialog header="Registro de antescedentes " widgetVar="widgetAntescedentes" id="dialogAntescedentes" modal="true">
            <h:form>
                <p:messages autoUpdate="true"/>
                <p:panelGrid>
                    <p:row>
                        <p:column>
                             <p:outputLabel value="Heredo-Familiares:" for="heredoFam"/>
                             <p:inputTextarea id="heredoFam" value="#{pacienteController.antescedentes.heredoFam}" required="true" label="Heredo_Familiares"/>
                        </p:column>  
                    </p:row>
                    <p:row>
                        <p:column>
                             <p:outputLabel value="Peronales patológicos:" for="persoPatologicos"/>
                             <p:inputTextarea id="persoPatologicos" value="#{pacienteController.antescedentes.persoPatologicos}" required="true" label="Personales patológicos"/>
                        </p:column>  
                    </p:row><p:row>
                        <p:column>
                             <p:outputLabel value="Personales no patológicos:" for="persoNoPato"/>
                             <p:inputTextarea id="persoNoPato" value="#{pacienteController.antescedentes.persoNoPato}" required="true" label="Personales no patológicos"/>
                        </p:column>  
                    </p:row>
                    <p:row>
                        <p:column>
                             <p:outputLabel value="Gineco-Obstétricos:" for="ginecoObstetricos"/>
                             <p:inputTextarea id="ginecoObstetricos" value="#{pacienteController.antescedentes.genecoObste}" required="true" label="Gineco-Obstétricos"/>
                        </p:column>  
                    </p:row>
                </p:panelGrid>
                <p:commandButton value="Create" actionListener="#{pacienteController.crearAntescedentes()}" oncomplete="if (args &amp;&amp; !args.validationFailed) PF('widgetAntescedentes').hide();" update=":accordion:antescedentesForm"/>
            </h:form>
        </p:dialog>
        
        
        
        
        <p:dialog header="Modificar antescedentes " widgetVar="widgetAntescedentes2" id="dialogAntescedentes2" modal="true">
            <h:form>
                <p:messages autoUpdate="true"/>
                <p:panelGrid>
                    <p:row>
                        <p:column>
                             <p:outputLabel value="Heredo-Familiares:" for="heredoFam"/>
                             <p:inputTextarea id="heredoFam" value="#{pacienteController.antescedentes.heredoFam}" required="true" label="Heredo_Familiares"/>
                        </p:column>  
                    </p:row>
                    <p:row>
                        <p:column>
                             <p:outputLabel value="Peronales patológicos:" for="persoPatologicos"/>
                             <p:inputTextarea id="persoPatologicos" value="#{pacienteController.antescedentes.persoPatologicos}" required="true" label="Personales patológicos"/>
                        </p:column>  
                    </p:row><p:row>
                        <p:column>
                             <p:outputLabel value="Personales no patológicos:" for="persoNoPato"/>
                             <p:inputTextarea id="persoNoPato" value="#{pacienteController.antescedentes.persoNoPato}" required="true" label="Personales no patológicos"/>
                        </p:column>  
                    </p:row>
                    <p:row>
                        <p:column>
                             <p:outputLabel value="Gineco-Obstétricos:" for="ginecoObstetricos"/>
                             <p:inputTextarea id="ginecoObstetricos" value="#{pacienteController.antescedentes.genecoObste}" required="true" label="Gineco-Obstétricos"/>
                        </p:column>  
                    </p:row>
                </p:panelGrid>
                <p:commandButton value="Edit" actionListener="#{pacienteController.editAntescedentes()}" oncomplete="if (args &amp;&amp; !args.validationFailed) PF('widgetAntescedentes2').hide();" update=":accordion:antescedentesForm"/>
            </h:form>
        </p:dialog>
        
        <p:dialog header="Subir imágen" widgetVar="widgetImagen" id="dialogImagen" modal="true">
            <h:form enctype="multipart/form-data">
                <!-- enctype="multipart/form-data", para subir archivos al servidor -->
                <p:messages autoUpdate="true"/>
                <p:panelGrid>
                    <p:row>
                        <p:column>
                            <p:outputLabel value="Nombre de la imágen: " for="Nombre"/>
                            <p:inputText value="#{pacienteController.imagen.nombre}" id="Nombre" required="true"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column>
                            <h:inputFile id="file" value="#{pacienteController.imagen.file}"/>
                        </p:column>
                    </p:row>
                </p:panelGrid>
                <h:commandButton value="Subir imagen" actionListener="#{pacienteController.crearImagen()}"/>
            </h:form>
        </p:dialog>
        
        <p:dialog header="Actualizar imágen" widgetVar="widgetImagen2" id="dialogImagen2" modal="true">
            <h:form enctype="multipart/form-data">
                <!-- enctype="multipart/form-data", para subir archivos al servidor -->
                <p:messages autoUpdate="true"/>
                <p:panelGrid>
                    <p:row>
                        <p:column>
                            <p:outputLabel value="Nombre de la imágen: " for="Nombre"/>
                            <p:inputText value="#{pacienteController.imagen.nombre}" id="Nombre" required="true"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column>
                            <h:inputFile id="file" value="#{pacienteController.imagen.file}"/>
                        </p:column>
                    </p:row>
                </p:panelGrid>
                <h:commandButton value="Actualizar imagen" actionListener="#{pacienteController.editarImagen()}"/>
            </h:form>
        </p:dialog>

        
    </ui:define>
</ui:composition>
